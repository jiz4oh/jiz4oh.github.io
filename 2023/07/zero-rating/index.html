<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"jiz4oh.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.14.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="免流的由来不知道各位是否还记得曾经被 5 元 30M 支配的恐惧吗？在大概 10 多年前，那时候的流量非常昂贵，网页也非常简单，大部分都是一些文字信息，随着时间的推移，互联网在飞速发展，手机上网从文字转变为了以视频和图片为主，网页内容越来越丰富，10M 流量几个图片就用完了，流量需求大幅提升，但是运营商套餐价格并没有随着需求的提升而降低，一度都是 5 元 30M 的离谱价格，人们为了（白嫖）推进运"><meta property="og:type" content="article"><meta property="og:title" content="谈谈免流"><meta property="og:url" content="http://jiz4oh.com/2023/07/zero-rating/index.html"><meta property="og:site_name" content="Jiz4oh&#39;s Life"><meta property="og:description" content="免流的由来不知道各位是否还记得曾经被 5 元 30M 支配的恐惧吗？在大概 10 多年前，那时候的流量非常昂贵，网页也非常简单，大部分都是一些文字信息，随着时间的推移，互联网在飞速发展，手机上网从文字转变为了以视频和图片为主，网页内容越来越丰富，10M 流量几个图片就用完了，流量需求大幅提升，但是运营商套餐价格并没有随着需求的提升而降低，一度都是 5 元 30M 的离谱价格，人们为了（白嫖）推进运"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jiz4oh/backups@master/img/2023/08/upgit_20230808_1691510056.png"><meta property="article:published_time" content="2023-07-27T11:20:30.000Z"><meta property="article:modified_time" content="2023-07-27T11:20:30.000Z"><meta property="article:author" content="jiz4oh"><meta property="article:tag" content="白嫖"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jiz4oh/backups@master/img/2023/08/upgit_20230808_1691510056.png"><link rel="canonical" href="http://jiz4oh.com/2023/07/zero-rating/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://jiz4oh.com/2023/07/zero-rating/","path":"2023/07/zero-rating/","title":"谈谈免流"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>谈谈免流 | Jiz4oh's Life</title><script async defer data-website-id="" src=""></script><script defer data-domain="" src=""></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1297217754235608" crossorigin="anonymous"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Jiz4oh's Life</p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%8D%E6%B5%81%E7%9A%84%E7%94%B1%E6%9D%A5"><span class="nav-number">1.</span> <span class="nav-text">免流的由来</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%8D%E6%B5%81"><span class="nav-number">2.</span> <span class="nav-text">什么是免流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%8D%E6%B5%81%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-number">3.</span> <span class="nav-text">免流的基本原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%8D%E6%B5%81%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">免流的几种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%85%8D%E6%B5%81"><span class="nav-number">4.1.</span> <span class="nav-text">本地免流</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E5%90%91%E5%85%8D%E6%B5%81"><span class="nav-number">4.2.</span> <span class="nav-text">定向免流</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%91%E7%AB%AF%E5%85%8D%E6%B5%81-%E4%BA%91%E5%85%8D"><span class="nav-number">4.2.1.</span> <span class="nav-text">云端免流(云免)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ip"><span class="nav-number">4.2.1.1.</span> <span class="nav-text">ip</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dns"><span class="nav-number">4.2.1.2.</span> <span class="nav-text">dns</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#http"><span class="nav-number">4.2.1.3.</span> <span class="nav-text">http</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%91%E5%85%8D%E5%8E%9F%E7%90%86"><span class="nav-number">4.2.1.4.</span> <span class="nav-text">云免原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E8%BF%9E%E5%85%8D%E6%B5%81"><span class="nav-number">4.2.2.</span> <span class="nav-text">直连免流</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9C%E6%9C%BA%E5%85%8D%E6%B5%81"><span class="nav-number">4.3.</span> <span class="nav-text">停机免流</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%8D%E6%B5%81%E7%9A%84%E5%B1%80%E9%99%90%E6%80%A7"><span class="nav-number">5.</span> <span class="nav-text">免流的局限性</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="jiz4oh" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">jiz4oh</p><div class="site-description" itemprop="description">莫见乎隐，莫显乎微，故君子慎其独也</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">12</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="cc-license animated" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a></div></div></div><div class="back-to-top animated" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://jiz4oh.com/2023/07/zero-rating/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="jiz4oh"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jiz4oh's Life"><meta itemprop="description" content="莫见乎隐，莫显乎微，故君子慎其独也"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="谈谈免流 | Jiz4oh's Life"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">谈谈免流</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-07-27 19:20:30" itemprop="dateCreated datePublished" datetime="2023-07-27T19:20:30+08:00">2023-07-27</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/network/" itemprop="url" rel="index"><span itemprop="name">网络</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>4.5k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>8 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="免流的由来"><a href="#免流的由来" class="headerlink" title="免流的由来"></a>免流的由来</h2><p>不知道各位是否还记得曾经被 5 元 30M 支配的恐惧吗？<br>在大概 10 多年前，那时候的流量非常昂贵，网页也非常简单，大部分都是一些文字信息，<br>随着时间的推移，互联网在飞速发展，手机上网从文字转变为了以视频和图片为主，网页内容越来越丰富，10M 流量几个图片就用完了，流量需求大幅提升，<br>但是运营商套餐价格并没有随着需求的提升而降低，一度都是 5 元 30M 的离谱价格，<br>人们为了（<del>白嫖</del>）推进运营商的技术发展，研究出了免流</p><h2 id="什么是免流"><a href="#什么是免流" class="headerlink" title="什么是免流"></a>什么是免流</h2><p>“免流”通常是指在移动网络中使用特定的应用或服务而不消耗用户的数据流量，即上网不要钱。<br>通常由移动运营商或特定的应用提供商推出，旨在吸引更多用户使用这些应用或服务。</p><span id="more"></span><h2 id="免流的基本原理"><a href="#免流的基本原理" class="headerlink" title="免流的基本原理"></a>免流的基本原理</h2><p>上述的免流通常局限于某些应用，我们所聊的免流是不限于特定应用的免流，通过特定手段欺骗运营商的计费系统达到免费的目的。<br>首先我们要了解运营商的计费系统是如何工作的</p><p>访问正常网站：</p><pre class="mermaid">
flowchart LR

subgraph 运营商
    direction LR
    A[&quot;计费系统

    baidu.com
    计费 1M&quot;]--&gt;B[&quot;代理服务器

    baidu.com&quot;]
end

用户--baidu.com--&gt;运营商--&gt;百度服务器
</pre><p>访问免流网站：</p><pre class="mermaid">
flowchart LR

subgraph 运营商
    direction LR
    A[&quot;计费系统

    10086.cn
    不计费&quot;]--&gt;B[&quot;代理服务器

    10086.cn&quot;]
end

用户--10086.cn--&gt;运营商--&gt;中国移动服务器
</pre><p>免流的核心原理就是让计费系统以为用户在访问免流网站，但实际上却访问了正常网站</p><pre class="mermaid">
flowchart LR

subgraph 运营商
    direction LR
    A[&quot;计费系统

    10086.cn
    不计费&quot;]--&gt;B[&quot;代理服务器

    baidu.com&quot;]
end

用户--baidu.com--&gt;运营商--&gt;百度服务器
</pre><h2 id="免流的几种方式"><a href="#免流的几种方式" class="headerlink" title="免流的几种方式"></a>免流的几种方式</h2><h3 id="本地免流"><a href="#本地免流" class="headerlink" title="本地免流"></a>本地免流</h3><p>本地免流是在用户手机上运行一个代理程序对所有数据包进行修改，从而欺骗计费系统</p><pre class="mermaid">
flowchart LR

subgraph 手机
    direction LR
    浏览器--baidu.com--&gt;代理程序
end

subgraph 运营商
    direction LR
    A[&quot;计费系统

    10086.cn
    不计费&quot;]--&gt;B[&quot;代理服务器

    baidu.com&quot;]
end

手机--&gt;运营商--&gt;百度服务器
</pre><p>代理程序的主要实现方式是对 http 数据包请求头进行修改。</p><p>请求头中有两个关键字段 Host 和 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xitang/archive/2011/11/07/2239454.html">X-Online-Host</a>。<br>假设计费系统是通过检测 http 数据包中的 Host 字段进行计费，代理服务器通过 http 数据包中的 X-Online-Host 进行实际数据访问，则可以通过修改 http headers 中的 Host 字段即可达到欺骗计费系统的目的。</p><p>运营商也不是傻子，对检测系统进行了更新，上述手段就失效了，后来各大网友开始了和运营商的斗志斗勇</p><ol><li>有插入两个 Host 字段的双 h 模式，让计费系统查看第一个 Host 字段，让代理服务器查看第二个 Host 字段</li><li>也有插入两个 X-Online-Host 的双 x 模式</li><li>伪首模式</li><li>伪彩模式</li><li>…</li></ol><p>本地免流优点是不需要额外的资源，在用户本地手机即可实现，主要利用的是运营商计费系统和代理服务器系统的实现差异；缺点是各地运营商的系统差异不一致，在上海能免的模式在广东并不一定通用，并且可利用修改的地方有限，所有模式被封禁后就无法使用了</p><p>本地免流最大的问题是因为当时运营商账单具有滞后性，当你之前使用的免流模式被修复后，流量已经开始正常计费，你却全然不知，第二天早上起来发现收到了 10086 的巨额账单</p><h3 id="定向免流"><a href="#定向免流" class="headerlink" title="定向免流"></a>定向免流</h3><p>2015 开始，国家要求三大运营商提速降费，漫游费逐渐被取消，流量都是全国通用，费用也越来越低，但流量费用还没低到可以任意挥霍的程度。<br>针对有些人喜欢看抖音，有些人喜欢看腾讯视频，三大运营商纷纷推出了定向流量卡，常见的有腾讯王卡，阿里宝卡等。<br>定向流量卡是针对某些互联网服务在通用流量之外给予大额的定向流量，比如腾讯王卡允许腾讯系应用免费使用最多 40G 流量。</p><p>定向免流就是针对这部分流量卡，将其他网站的流量伪装成特定应用的流量使用实现定向流量，并不是完全的无限流量。<br>比如使用腾讯王卡时将其他应用如抖音的流量伪装成腾讯系应用的流量</p><pre class="mermaid">
flowchart LR

subgraph 手机
    direction LR
    浏览器--baidu.com--&gt;代理程序
end

subgraph 运营商
    direction LR
    A[&quot;计费系统

    qq.com
    定向流量计费1M&quot;]--&gt;B[&quot;代理服务器

    baidu.com&quot;]
end

手机--&gt;运营商--&gt;百度服务器
</pre><h4 id="云端免流-云免"><a href="#云端免流-云免" class="headerlink" title="云端免流(云免)"></a>云端免流(云免)</h4><p>本地免流利用了计费系统和代理服务器之间的差异，后续差异被不断补全（感谢各大网友自费做 QA），甚至后来运营商取消了代理服务器，直接使用计费系统进行互联网访问，本地免流就此绝迹。<br>后面常用的一般都是云端免流，这是现在的主流免流方式。</p><p>云端免流的原理需要一点网络协议的基础知识，了解 tcp/ip 的工作原理</p><h5 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h5><p>现有互联网是基于 tcp/ip 为架构组成的，计算机之间的通信并不是基于域名而是基于 ip 协议。</p><p>ip 协议可以理解为是计算机中的电话号码，比如我们想要联系张三的时候，我们可以通过输入张三的电话号码 123456 拨打电话联系到他</p><h5 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h5><p>但目前我们访问网站的时候是通过输入域名，为什么计算机之间的通信却基于 ip 协议？他们之间是如何转换的？</p><p>这就是 dns 所做的事情。<br>因为 ip 地址不易于记忆以及输入，所以域名被发明出来简化输入，相当于是电话号码的联系人名称，比如我们通常在电话薄里面保存张三的电话号码为 123456，张三就相当于是域名，123456 是 ip，我们想要联系张三的时候只需要在电话薄里面搜索 ‘张三’，而不是输入 123456</p><p>dns 的作用就是查询电话薄，比如我想要访问 google.com 的时候，计算机并不知道应该如何访问到 google.com，所以它需要去向电话薄查询 (dns query) google.com 的电话 (ip)</p><pre class="mermaid">
sequenceDiagram
    participant User
    participant Computer
    participant DNS Server
    participant Google

User-&gt;&gt;Computer: User open browser and enter &#39;google.com&#39;
Computer-&gt;&gt; DNS Server: Computer send DNS query to DNS Server
DNS Server--&gt;&gt;Computer: DNS Server response 123456 to Computer
Computer-&gt;&gt;Google: Computer send request to Google
Google--&gt;&gt;Computer: Google response to Computer
Computer--&gt;&gt;User: Computer display the response
</pre><h5 id="http"><a href="#http" class="headerlink" title="http"></a>http</h5><p>http 协议是普通人最常见的互联网协议，是互联网的基石，我们常见的所有应用几乎都是使用 http 协议进行通信。</p><p>http 协议请求结构如下</p><pre class="line-numbers language-none"><code class="language-none">GET &#x2F; HTTP&#x2F;1.1
Host: www.baidu.com

xxxxxxx此处即是http请求内容正文xxxxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在本地免流中，我们采用的是修改 Host 字段绕过计费系统。<br>在云端免流中，采用的方式其实也类似，区别其实是在于绕过计费系统之后如何访问正确的目标网站？</p><p>思路其实很简单，既然本地免流由于运营商的代理服务器和计费系统合并而被彻底修复，那我们如果能够自己实现一个代理服务器不就和之前的方式类似了吗？</p><pre class="mermaid">
flowchart LR

subgraph 运营商
    direction LR
    A[&quot;计费系统

    10086.cn
    不计费&quot;]
end

subgraph 云端服务器
    direction LR
    B[&quot;baidu.com&quot;]
end

用户--baidu.com--&gt;运营商--&gt;云端服务器--&gt;百度服务器
</pre><h5 id="云免原理"><a href="#云免原理" class="headerlink" title="云免原理"></a>云免原理</h5><p>具体是将原始请求封装到 http body 中并发送给代理服务器，代理服务器解析 http body 之后还原原始请求并进行实际请求</p><p><img src="https://cdn.jsdelivr.net/gh/jiz4oh/backups@master/img/2023/08/upgit_20230808_1691510056.png" alt="upgit_20230808_1691510056.png"></p><p>即</p><pre class="mermaid">
sequenceDiagram
    participant User
    participant 运营商
    participant 云端服务器 as 云端服务器(10.10.10.10)
    participant 百度服务器 as 百度服务器(3.3.3.3)

User--&gt;&gt;运营商: 发送一个数据包到 10.10.10.10 并在 http header 中标注这是发给 10086.cn 的数据包
运营商--&gt;&gt;云端服务器: 计为免费并将数据包发送给 10.10.10.10
云端服务器--&gt;&gt;百度服务器: 解开数据包并发送给实际请求地址 3.3.3.3
百度服务器-&gt;&gt;云端服务器: 返回内容
云端服务器-&gt;&gt;运营商: 返回内容
运营商-&gt;&gt;User: 返回内容
</pre><h4 id="直连免流"><a href="#直连免流" class="headerlink" title="直连免流"></a>直连免流</h4><p>定向免流还有一种免流方式，不需要云端服务器。<br>有些定向卡是允许免去某个应用的所有流量而不是某个特定域名的流量，比如腾讯王卡可以免去 qq 浏览器的所有流量，原理是在该应用中内置一个代理服务器，代理服务器产生的流量被运营商计入定向流量。</p><p>直连免流就是通过抓包获取应用内置的代理服务器并将其用于所有应用访问。</p><p>不过因为现在代理服务器都增加了动态验证，基本都失效了。</p><h3 id="停机免流"><a href="#停机免流" class="headerlink" title="停机免流"></a>停机免流</h3><p>电信会在用户停机之后给用户开通一个花费充值的绿色通道，这样即使你停机之后仍然能够通过访问网络缴存话费。所以和定向免流类似，停机免流的实现原理也是通过将 Host 改为绿通的网址就能实现免流了。</p><p>对于停机用户来说，每个月只需要缴纳停机保号费用（通常5元）即可实现无限流量。不过电信随即采取了相应的策略，大部分地区对停机用户的上网速度施加了限制，毕竟你充个话费要那么快干嘛。</p><h2 id="免流的局限性"><a href="#免流的局限性" class="headerlink" title="免流的局限性"></a>免流的局限性</h2><p>因为运营商的计费系统如何工作其实是一个黑盒，外界很难得知什么时候工作机制就发生了变化，比如除了检查 host 字段，计费系统也可以检查端口。互联网的流量通常使用的都是 80/443，所以云端服务器的端口通常必须使用 80/443。</p><p>另一个缺点是为了实现免流必须使用全局代理，也就是不管国内还是国外流量均需通过云端服务器进行代理，如果云端服务器在国外，那么访问国内的服务会变得很慢，并且有些服务只能是国内 ip 才能使用；如果云端服务器在国内，那还需要一台额外的国外节点进行翻墙代理，以及国内服务器商宽其实非常昂贵，一年花销可能需要好几千，买服务器的钱可能比你免的流量贵的多得多。</p></div><footer class="post-footer"><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>jiz4oh</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://jiz4oh.com/2023/07/zero-rating/" title="谈谈免流">http://jiz4oh.com/2023/07/zero-rating/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"><a href="/tags/freebie/" rel="tag"># 白嫖</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2023/04/build-own-rss-platform/" rel="prev" title="构建自己的 rss 平台"><i class="fa fa-chevron-left"></i> 构建自己的 rss 平台</a></div><div class="post-nav-item"><a href="/2024/09/tailscale-with-clash/" rel="next" title="Tailscale 与 clash 共存">Tailscale 与 clash 共存 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><script src="https://giscus.app/client.js" data-repo="jiz4oh/jiz4oh.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyOTg0MTgyNjU=" data-category="Announcements" data-category-id="DIC_kwDOEcmAWc4CTZlo" data-mapping="og:title" data-reactions-enabled="1" data-emit-metadata="1" data-theme="light" data-lang="zh-CN" crossorigin="anonymous" data-input-position="bottom" data-loading="lazy" async></script></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">jiz4oh</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">94k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">2:51</span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><div class="reading-progress-bar"></div><a href="https://github.com/jiz4oh" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="300" alpha="0.6" zindex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.3.0/mermaid.min.js","integrity":"sha256-QdTG1YTLLTwD3b95jLqFxpQX9uYuJMNAtVZgwKX4oYU="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/pace.js"></script></body></html>